ECHOOFF();
// URL of the mail send program
var SEND_MAIL_URL =
  "https://amjp.psy-k.org/JPLY_BBS/scripts/send_mail.JS_BASIC";

var READ_MAIL_URL =
  "https://amjp.psy-k.org/JPLY_BBS/scripts/mail_read_latest.JS_BASIC";

var MAIL_RECEIVE_URL =
  "https://amjp.psy-k.org/JPLY_BBS/server_side/mail_receive.php";

var PROXY =
  "https://amjp.psy-k.org/JPLY_BBS/scripts/proxy.php?url=";

login_art = await CURL("https://amjp.psy-k.org/JPLY_BBS/utf8-art/JPLY_BBS/proxy.php?url=https://amjp.psy-k.org/JPLY_BBS/utf8-art/JPLY_BBS/JPLY_BBS_LOGIN_SCREEN1COLOR.txt");
await SLOWPRINT(login_art,2);
COLOR(12,0);
quit=false;
while(quit==false) {
    await SLOWPRINT(translate["enter nick or reg."],2);
    NICK = await INPUT();
    REGISTER = NICK.toUpperCase();
    if(REGISTER=="REGISTER"||REGISTER=="REGISTRAR"||REGISTER=="ユーザー登録") {
        REGSCRIPT = await CURL("https://amjp.psy-k.org/JPLY_BBS/utf8-art/JPLY_BBS/proxy.php?url=https://amjp.psy-k.org/JPLY_BBS/scripts/registration.JS_BASIC");
        await LOAD(REGSCRIPT);    
    }
    await SLOWPRINT(translate["pw prompt"],2);
    PASSWORD = await INPUT("");
    var response = await CURL('https://amjp.psy-k.org/JPLY_BBS/server_side/is_loged_in.php', {
        data: 'nick='+NICK+'&pw='+PASSWORD
    });
    await MORE(response);
    if(response=="OK") {
        await SLOWPRINT(translate["welcome"]+NICK+"!",2);
        graffiti_wall = await CURL("https://amjp.psy-k.org/JPLY_BBS/utf8-art/JPLY_BBS/proxy.php?url=https://amjp.psy-k.org/JPLY_BBS/scripts/graffiti_wall.JS_BASIC");
        await LOAD(graffiti_wall);
        //check for mail
        var code = await CURL(PROXY + encodeURIComponent(
            "https://amjp.psy-k.org/JPLY_BBS/scripts/check_mail.JS_BASIC"
        ));
        LOAD(code);          
        main_menu = await CURL("https://amjp.psy-k.org/JPLY_BBS/utf8-art/JPLY_BBS/proxy.php?url=https://amjp.psy-k.org/JPLY_BBS/scripts/main_menu.JS_BASIC");
        await LOAD(main_menu);
    }
}